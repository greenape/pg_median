SELECT v,  rolling_median_impute(v, 3) over() FROM (VALUES (1), (1.1), (0.9), (NULL), (0.95), (2.1), (1.95), (2.0), (2.05), (3.11), (2.99), (3.05), (3.0)) as t(v);
  v   | rolling_median_impute 
------+-----------------------
    1 |                     1
  1.1 |                   1.1
  0.9 |                   0.9
      |                  0.95
 0.95 |                  0.95
  2.1 |                   2.1
 1.95 |                  1.95
  2.0 |                     2
 2.05 |                  2.05
 3.11 |                  3.11
 2.99 |                  2.99
 3.05 |                  3.05
  3.0 |                     3
(13 rows)

SELECT v,  rolling_median_impute(v::double precision, 3) over() FROM (VALUES (NULL)) as t(v);
ERROR:  window size greater than number of values
DETAIL:  window size 3 is greater than total number of elements in partition: 1
HINT:  reduce window size
SELECT v,  rolling_median_impute(v, 3) over() FROM (VALUES (1), (1.1), (NULL), (NULL)) as t(v);
ERROR:  Too few non-nulls
DETAIL:  window size 3 is greater than total number of non-null elements in partition: 2
HINT:  reduce window size
SELECT v,  rolling_median_impute(v, 3) over() FROM (VALUES (1), (1.1), (0.9), (NULL), (NULL), (2.1), (NULL), (2.0), (2.05), (3.11), (2.99), (3.05), (NULL)) as t(v);
  v   | rolling_median_impute 
------+-----------------------
    1 |                     1
  1.1 |                   1.1
  0.9 |                   0.9
      |                   1.1
      |                   1.1
  2.1 |                   2.1
      |                     2
  2.0 |                     2
 2.05 |                  2.05
 3.11 |                  3.11
 2.99 |                  2.99
 3.05 |                  3.05
      |                  2.99
(13 rows)

SELECT v,  rolling_median_impute(v::double precision, 3) over() FROM (VALUES (NULL), (NULL), (NULL)) as t(v);
ERROR:  Too few non-nulls
DETAIL:  window size 3 is greater than total number of non-null elements in partition: 0
HINT:  reduce window size
